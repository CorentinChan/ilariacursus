<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
   <link rel="stylesheet" href="style.css"> 
      <link rel="stylesheet" href="styleResp.css"> 
     <script src="script.js" defer></script>
  <!-- <script src="search.js" defer></script> --> 
  <link rel="stylesheet" href="animation.css"> 


<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

   <title><%=title%></title>
</head>
<body>

  <!--navigation bar -->
   <%- include('part/nav', { user: user }) %>



<div class=" container-fluid recipe-container2 fade-in">

  <!--recipe  search form-->

<section class="d-lg-flex recipeForm  ">
  <div class="container-fluid mx-2 mt-3">
  <div class="   d-lg-flex mx-lg-0" role="search">
      <form method="post" action="/searchRecipes">
    <div class="input-group w-lg-50 slide-in-blurred-left">
            <span class="input-group-text btnSearch" id="basic-addon1">
        <button type="submit" style="border: none; background: none;"><i class="fa-solid fa-magnifying-glass " ></i></button>
      </span>   
      <input type="text" class="form-control w-lg-50" placeholder="Search" id="textSearch" name="textSearch" aria-label="Search" aria-describedby="basic-addon1">
    </div>
      </form>
  </div>
</div>



<!--
 <form class="d-flex">
        <input class="form-control me-2" type="text" placeholder="Search">
        <button class="btn btn-primary" type="button">Search</button>
 </form>
 -->
<div class=" searchList mt-2">
  <form action="/searchRecipes" method="POST">
          <input hidden name="formSelect" value="true">
    <select class="form-select fs-5 rounded-pill form-select-lg mx-2 mx-lg-5 form-select2 "  onchange="this.form.submit()"  id="recipeFilter" name="searchFilter">
      <option selected disabled>Sort by : </option>
      <option value="date">Sort by : date</option>
      <option value="title">Sort by : A to Z</option>
      <option value="note">Sort by : note </option>
    </select>
    </form>
</div>  

</section>
<!--recipe results on caroussel( with bootstrap)  -->
    <section class="recipeList2 ">

               <div class="container-fluid py-3">
  <div id="cardCarousel" class="carousel slide" data-bs-ride="false">
    <div class="carousel-inner">

      <% let count = 0; let nbSlide=1; %>
      <% recipes.forEach((recipe, index) => {
        console.log("recipeid : "+recipe.id);     
       if(!recipe.image)recipe.image="https://www.akteos.com/fileadmin/mediatheque/blog/2021/02/Article-Chine-diner.jpeg";
 %>

        <% if (count === 0) { %>
          <div class="carousel-item <%= index === 0 ? 'active' : '' %>">
            <div class="row g-3">
        <% } %>

        <div class="col-6 col-lg-4">
          
          <form method="post" action="/goRecipe" id="myForm" >
                <button type="submit" class="p-0 border-0 bg-transparent w-100">
            <input hidden name="recipeID" value ="<%=recipe.id%>" >
          <div class="card shadow-sm h-100" >
            <img src="<%= recipe.image %>" class="card-img-top" alt="<%= recipe.title %>">
            <div class="card-body pb-0">
              <h5 class="card-title"><%= recipe.title %></h5>
              <div class="d-flex justify-content-between pt-3 pb-0 mb-0">
                <span><%=recipe.note%><i class=" pb-1 ms-1 fa-solid fa-star"></i></span>
                <span class="card-text"><%= recipe.auteur %></span>
              </div>
            </div>
          </div>
        </div>
      </button>
        </form>
        <% count++; %>
        <% if (count >= 12 || index === recipes.length - 1) { %>
            </div>
          </div>
          <% 
          if (count >= 12){nbSlide++;count = 0;} }console.log(recipes.length) %>
       

      <% }); %>

    </div>
     <!-- Indicators-->
  <div class="carousel-indicators  position-static mt-3 justify-content-center" href="#cardCarousel">
        <button class="btn btn-outline-primary bg-white " type="button" data-bs-target="#cardCarousel" data-bs-slide="prev">
      ⬅️ 
    </button>
    <div class="d-flex numeroButton " id="numeroButton">
    <button type="button" data-bs-target="#cardCarousel" data-bs-slide-to="0" class="active bg-white text-black-50" href="#cardCarousel">1</button>
     <% console.log(nbSlide);  for (let i = 1; i < nbSlide; i++) { console.log(i); %>
     
 <button type="button" class=" bg-white text-black-50" data-bs-target="#cardCarousel" data-bs-slide-to="<%=i%>"  href="#cardCarousel" value=""><%=(i+1)%></button>   
    <% } %> 
          </div>
     <button class="btn btn-outline-primary bg-white" type="button" data-bs-target="#cardCarousel" data-bs-slide="next">
       ➡️
    </button>
  </div>

   

        </section>

  </div>
</div>


 <%- include('part/footer', { user: user }) %>

 <%- include('part/sign', { user: user}) %>


</body>
</html>